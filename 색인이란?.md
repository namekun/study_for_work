---


---

<h1 id="색인">색인</h1>
<h2 id="색인-종류">01 . 색인 종류</h2>
<ul>
<li>전체 색인(static idx) : 정적 색인이라고도 하며, 색인을 시도하는 시점 이전의 데이터를 수집/색인한다.</li>
<li>증분색인(dynamic idx) : 동적 색인이라고도 하며 전체색인 완료 시점부터 추가된 데이터를 수집/색인한다.</li>
<li>메뉴얼색인(manual idx) : 데이터의 PrivateKey 혹은 고유값을 통한 데이터 재 수집/ 재 색인한다.</li>
</ul>
<h2 id="전체-색인">전체 색인</h2>
<ul>
<li>
<p>진행과정</p>
<ul>
<li>데이터 수집 대상 테이블에 추가/입력되는 데이터가 없다면 <strong>그 테이블에 입력된 row 갯수만큼 데이터 수집/색인 작업진행</strong></li>
<li>데이터 수집 대상 테이블에 추가/입력되는 데이터가 있다면 <strong>색인시도 시점 이전에 입력된 row 갯수만큼 데이터 수집/색인 작업진행</strong></li>
</ul>
<p><img src="https://t1.daumcdn.net/cfile/tistory/22279A4956D9256428" alt="enter image description here"></p>
</li>
</ul>
<h2 id="증분색인">증분색인</h2>
<ul>
<li>
<p>개요</p>
<ul>
<li>데이터 수집 대상 테이블에 추가/입력된 데이터를 수집/색인하는 작업</li>
<li>증분 색인 방법으로 여러가지가 있으나, <strong>날짜기준 수집/색인</strong> 과 <strong>CRUD 발생시에 Queue 기록 수집 색인</strong>이 주류를 이룬다.</li>
</ul>
</li>
<li>
<p>날짜기준 수집/색인 방법</p>
<ul>
<li>검색엔진에 최종적으로 수집/색인된 데이터의 날짜를 가지고 와서 그 날짜 이후 입력된 데이터를 select한다.
<ul>
<li>ex&gt; 검색엔진에 최종적으로 수집/색인된 데이터의 날짜 : 2016-03-04<br>
이때 데이터 수집용 쿼리<br>
<code>select * from t_board where create_date &gt; 2016-03-04</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>단점</p>
<ul>
<li>수집 대상 데이터가 삭제될 경우 검색엔진에 반영이 불가</li>
<li>수집 대상 데이터가 누락되는 경우가 발생</li>
<li>수집 대상 데이터의 대량 수정시 검색엔진에 반영하기 위해선 별도의 후처리가 필요( 입력된 데이터의 최종수정일을 변경하는 등의 작업)</li>
</ul>
</li>
<li>
<p>CRUD 발생시 Queue 기록 수집/색인 방법</p>
<ul>
<li>
<p>구조적으로 정해진 방법은 없으며 핵심은 <strong>데이터 CRUD에 대한 히스토리를 기록하여 기록된 정보를 가지고 데이터의 수집/색인이 이루어지도록 하는 것이다.</strong></p>
</li>
<li>
<p>방법</p>
<ul>
<li>ex1
<ul>
<li>수집 대상 테이블의 CRUD 발생시 트리거를 통해 특정 테이블(<em>search_queue</em>)에 CRUD가 발생한 데이터의 PK값과 이루어진 action값 입력</li>
</ul>
</li>
<li>ex2
<ul>
<li>데이터 CRUD가 이루어지는 application영역에서 해당 작업 완료 후 별도 테이블(<em>search_queue</em>)에 완료한 작업의 action 값과 PK 값 입력</li>
</ul>
</li>
</ul>
</li>
<li>
<p>장점</p>
<ul>
<li>데이터에 대한 누락없이 수집/색인이 가능</li>
<li>수집 대상 데이터의 대량 수정시 구분값으로 일상적인 증분색인 영향없이 별도의 증분색인 작업으로 분리하기 용이</li>
<li>수집/색인에 대한 작업내역 추적이 용이하다.</li>
</ul>
<p><img src="https://t1.daumcdn.net/cfile/tistory/277B6F3D56D92DE60B" alt="enter image description here"></p>
</li>
</ul>
</li>
</ul>
<h2 id="메뉴얼-색인">메뉴얼 색인</h2>
<ul>
<li>
<p>진행과정</p>
<ul>
<li>데이터 수집 대상 테이블에서 특정 PK값을 조회하여 데이터 재 색인 과정을 거친다.</li>
<li>보통 전체색인 쿼리에서 where 조건에 조회할 PK값을 넣어 데이터 색인/수집을 진행한다.</li>
<li>증분색인 방법에 태워 별도의 작업 없이 queue에 update action 값과 대상 PK값을 기록하여 메뉴얼 색인 작업을 대신 할 수도 있다.</li>
</ul>
</li>
</ul>

